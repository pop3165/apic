module odl {
  namespace "http://tail-f.com/ned/odl";
  prefix odl;

  import tailf-ncs-ned {
    prefix ned;
  }

  import tailf-common {
    prefix tailf;
  }
  
  import ietf-inet-types {
	prefix inet;
  }

  identity odl-id {
    base ned:generic-ned-id;
  }

  typedef pcc-sync-state {
      type enumeration {
          enum initial-resync {
              description
                  "Initial state resynchronization is being performed.";
          }
          enum synchronized {
              description
                  "State synchronization has been achieved.";
          }
      }
  }
  
  grouping pcep-client-attributes {
      container path-computation-client {
          leaf ip-address {
              type inet:ip-address;
          }
          container stateful-tlv {
        	  container stateful {
        		  leaf initiation {
        			  type boolean;
        		  }
        		  leaf lsp-update-capability {
        			  type boolean;
        		  }
        	  }
          }
          leaf state-sync {
              type pcc-sync-state;
              when "../stateful-tlv";
          }
          list reported-lsp {
              leaf name {
                  type string;
              }
              key name;
              list path {
                  leaf lsp-id {
                      type uint32;
                      mandatory true;
                  }
                  key lsp-id;
                  /*
                  uses explicit-route-object;
                  */
                  uses lsp-attributes;
              }
          }
      }
  }

  list pcep-topology {
  	key topology-id;
	leaf topology-id {
      type string;
	}
	
	list node {
	  leaf node-id {
		type string;
      }
      key node-id;
      uses pcep-client-attributes;
    }
  }
  
  grouping reported-route-object {
  }
  
  grouping lsp-id {
      leaf node {
          type string;
          mandatory true;
      }
      leaf name {
          type string;
          mandatory true;
      }
  }
  
  grouping lsp-attributes {
	  container lsp {
		  leaf delegate {
			  type boolean;
			  mandatory true;
		  }
		  leaf administrative {
			  type boolean;
			  mandatory true;
		  }
	  }
  }
  
  grouping endpoints-object {
	  container endpoints-obj {
		  choice address-family {
	          mandatory true;
	          case ipv4-case {
	              container ipv4 {
	                  leaf source-ipv4-address {
	                      type inet:ipv4-address;
	                      mandatory true;
	                  }
	
	                  leaf destination-ipv4-address {
	                      type inet:ipv4-address;
	                      mandatory true;
	                  }
	              }
	          }
	          case ipv6-case {
	              container ipv6 {
	                  leaf source-ipv6-address {
	                      type inet:ipv6-address;
	                      mandatory true;
	                  }
	
	                  leaf destination-ipv6-address {
	                      type inet:ipv6-address;
	                      mandatory true;
	                  }
	              }
	          }
		  }
	  }
  }
  
  grouping explicit-route-object {
      container ero {
          list subobject {
        	  min-elements 1;
              leaf loose {
                  type boolean;
                  mandatory true;
              }
              leaf ip-prefix {
            	  type inet:ip-prefix;
            	  mandatory true;
              }
          }
      }
  }
  
  grouping add-lsp-args {
      uses lsp-id;
      container arguments {
    	  uses lsp-attributes;
          uses endpoints-object;
          uses explicit-route-object;
      }
  }
  
  grouping update-lsp-args {
      uses lsp-id;
      container arguments {
    	  uses lsp-attributes;
          uses explicit-route-object;
      }
  }
  
  grouping remove-lsp-args {
      uses lsp-id;
  }
  
  rpc add-lsp {
	tailf:actionpoint ncsinternal {
	  tailf:internal;
	}
    input {
      uses add-lsp-args;
      leaf network-topology {
    	type string;
    	mandatory true;
      }
    }
    output {
      leaf operation-result {
        type string;
      }
    }
  }
  
  rpc update-lsp {
	tailf:actionpoint ncsinternal {
	  tailf:internal;
	}
    input {
      uses update-lsp-args;
      leaf network-topology {
        type string;
        mandatory true;
      }
    }
    output {
  	  leaf operation-result {
        type string;
  	  }
    }
  }
  
  rpc remove-lsp {
	tailf:actionpoint ncsinternal {
	  tailf:internal;
	}
    input {
      uses remove-lsp-args;
      leaf network-topology {
        type string;
        mandatory true;
      }
    }
    output {
      leaf operation-result {
        type string;
      }
    }
  }
}




